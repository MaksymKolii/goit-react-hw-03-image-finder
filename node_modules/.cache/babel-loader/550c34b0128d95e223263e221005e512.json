{"ast":null,"code":"var _jsxFileName = \"E:\\\\GOIT_Course\\\\REACT\\\\goit-react-hw-03-image-finder\\\\src\\\\components\\\\App.jsx\";\nimport React, { Component } from 'react';\nimport { GlobalStyle } from './utils/GlobalStyles';\nimport { APP } from './App.styled';\nimport { fetchImages } from 'services/apiFetcher';\nimport { Searchbar } from './Searchbar/Searchbar';\nimport { imagesMapper } from '../services/imageMapper';\nimport { ImagesGallery } from './ImageGallery/ImageGallery';\nimport { Loader } from './Loader/Loader';\nimport { Button } from './Button/Button';\nimport { Modal } from './Modal/Modal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class App extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      images: [],\n      clickedImageUrl: null,\n      page: 1,\n      query: null,\n      isLoading: false,\n      totPages: null\n    };\n\n    this.getCkickedImgUrl = data => {\n      this.setState({\n        clickedImageUrl: data\n      });\n    };\n\n    this.getImages = async () => {\n      const {\n        page,\n        query\n      } = this.state;\n      this.setState({\n        isLoading: true\n      });\n\n      try {\n        const array = await fetchImages(query, page);\n\n        if (!array.hits.length) {\n          alert('Sorry, there are no images matching your search query. Please try again.');\n        }\n\n        this.setState({\n          totPages: Math.floor(array.totalHits / 12)\n        });\n        console.log(array);\n        console.log(array.totalHits);\n        this.setState(prev => ({\n          images: [...prev.images, ...imagesMapper(array.hits)]\n        }));\n        this.setState({\n          isLoading: false\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    this.nextPage = () => {\n      this.setState(_ref => {\n        let {\n          page\n        } = _ref;\n        return {\n          page: page + 1\n        };\n      });\n    };\n\n    this.closeModal = () => {\n      this.setState({\n        clickedImageUrl: null\n      });\n    };\n\n    this.onFormSubmit = query => {\n      this.setState({\n        query,\n        page: 1,\n        images: []\n      });\n    };\n\n    this.scrollHandler = () => {\n      window.scrollTo({\n        top: document.documentElement.scrollHeight,\n        behavior: 'smooth'\n      });\n    };\n  }\n\n  componentDidUpdate(_, prev) {\n    const {\n      images,\n      page,\n      totPages,\n      query\n    } = this.state;\n\n    if (prev.page !== page || prev.query !== query) {\n      this.getImages();\n    }\n\n    if (page <= totPages && images !== prev.images && page !== 1) {\n      alert(\"We're sorry, but you've reached the end of search results.\");\n    }\n\n    this.scrollHandler();\n  }\n\n  render() {\n    const {\n      images,\n      isLoading,\n      page,\n      totPages,\n      clickedImageUrl\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(APP, {\n      children: [/*#__PURE__*/_jsxDEV(Searchbar, {\n        onSubmit: this.onFormSubmit,\n        loading: isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), images && /*#__PURE__*/_jsxDEV(ImagesGallery, {\n        options: images,\n        onClick: this.getCkickedImgUrl\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this), isLoading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this) : images && page < totPages && /*#__PURE__*/_jsxDEV(Button, {\n        onClick: this.nextPage,\n        loading: isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }, this), clickedImageUrl && /*#__PURE__*/_jsxDEV(Modal, {\n        closeModal: this.closeModal,\n        url: clickedImageUrl\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(GlobalStyle, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["E:/GOIT_Course/REACT/goit-react-hw-03-image-finder/src/components/App.jsx"],"names":["React","Component","GlobalStyle","APP","fetchImages","Searchbar","imagesMapper","ImagesGallery","Loader","Button","Modal","App","state","images","clickedImageUrl","page","query","isLoading","totPages","getCkickedImgUrl","data","setState","getImages","array","hits","length","alert","Math","floor","totalHits","console","log","prev","error","nextPage","closeModal","onFormSubmit","scrollHandler","window","scrollTo","top","document","documentElement","scrollHeight","behavior","componentDidUpdate","_","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { GlobalStyle } from './utils/GlobalStyles';\r\nimport { APP } from './App.styled';\r\nimport { fetchImages } from 'services/apiFetcher';\r\nimport { Searchbar } from './Searchbar/Searchbar';\r\nimport { imagesMapper } from '../services/imageMapper';\r\nimport { ImagesGallery } from './ImageGallery/ImageGallery';\r\nimport { Loader } from './Loader/Loader';\r\nimport { Button } from './Button/Button';\r\nimport { Modal } from './Modal/Modal';\r\n\r\nexport class App extends Component {\r\n  state = {\r\n    images: [],\r\n    clickedImageUrl: null,\r\n    page: 1,\r\n    query: null,\r\n    isLoading: false,\r\n    totPages: null,\r\n  };\r\n\r\n  componentDidUpdate(_, prev) {\r\n    const { images, page, totPages, query } = this.state;\r\n\r\n    if (prev.page !== page || prev.query !== query) {\r\n      this.getImages();\r\n    }\r\n    if (page <= totPages && images !== prev.images && page !== 1) {\r\n      alert(\"We're sorry, but you've reached the end of search results.\");\r\n    }\r\n    this.scrollHandler();\r\n  }\r\n\r\n  getCkickedImgUrl = data => {\r\n    this.setState({ clickedImageUrl: data });\r\n  };\r\n\r\n  getImages = async () => {\r\n    const { page, query } = this.state;\r\n    this.setState({ isLoading: true });\r\n    try {\r\n      const array = await fetchImages(query, page);\r\n\r\n      if (!array.hits.length) {\r\n        alert(\r\n          'Sorry, there are no images matching your search query. Please try again.'\r\n        );\r\n      }\r\n      this.setState({ totPages: Math.floor(array.totalHits / 12) });\r\n\r\n      console.log(array);\r\n      console.log(array.totalHits);\r\n      this.setState(prev => ({\r\n        images: [...prev.images, ...imagesMapper(array.hits)],\r\n      }));\r\n      this.setState({ isLoading: false });\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  nextPage = () => {\r\n    this.setState(({ page }) => ({\r\n      page: page + 1,\r\n    }));\r\n  };\r\n\r\n  closeModal = () => {\r\n    this.setState({ clickedImageUrl: null });\r\n  };\r\n\r\n  onFormSubmit = query => {\r\n    this.setState({\r\n      query,\r\n      page: 1,\r\n      images: [],\r\n    });\r\n  };\r\n\r\n  scrollHandler = () => {\r\n    window.scrollTo({\r\n      top: document.documentElement.scrollHeight,\r\n      behavior: 'smooth',\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { images, isLoading, page, totPages, clickedImageUrl } = this.state;\r\n\r\n    return (\r\n      <APP>\r\n        <Searchbar onSubmit={this.onFormSubmit} loading={isLoading}></Searchbar>\r\n        {images && (\r\n          <ImagesGallery options={images} onClick={this.getCkickedImgUrl} />\r\n        )}\r\n\r\n        {isLoading ? (\r\n          <Loader />\r\n        ) : (\r\n          images &&\r\n          page < totPages && (\r\n            <Button onClick={this.nextPage} loading={isLoading} />\r\n          )\r\n        )}\r\n        {clickedImageUrl && (\r\n          <Modal closeModal={this.closeModal} url={clickedImageUrl} />\r\n        )}\r\n\r\n        <GlobalStyle />\r\n      </APP>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}